TODO short term

TODO: report type problem in WebViewPrim.viewEdit
BUG: empty script in mkWebView creates problem
BUG: pressing button while focus on text field has weird behavior
BUG?: Firefox on Oblomov mentions Empty string passed to getElementById()
DESIGN: changes in view lead to re-evaluating view script
  may be problematic if there is init code in there.
  for now time is set to nothing, because it cause re-evaluation as somehow it switched between Nothing and Just (18,30)
  will explicit view id references in the script cause problems?

Longer term
get rid of ' in webview type selectors

String max size? make sure that scripts cannot go wrong

Generics.replace what is this, also for label or other widgets?
present LabelView not implemented

edit on LabelView? (will need to implement Generics.replace) 

BUG sometimes the new node list is not empty after processing updates. Unable to reproduce reliably. Might depend on the state of Firefox as well.
The most likely revision in which it occurs is revision 2635 for Reservations/Main.hs and 2632 for the rest. 


Are responses from server guaranteed in correct order? Otherwise, make a queue.

Can the server process updates multithreaded? If so, need to block. 

multiple browser windows/tabs are fatal

Int ids are way too dangerous! encode them in something that cannot accidentally be used
BUG: without firebug, console is not declared, and webviews fails completely

Design
Figure out whether and how to parameterize withEditAction and withEditActionAttr
What about button edit actions?
 
Accessing text from a textView in an edit action is tricky. We don't want to take it directly from the (Widget..(TextView ..str)) but look it up by its id.
How can this confusion be removed?

Need extra state (think of good name) on client side
JSVar seems awkward. (and if we keep it, need to figure out if it really needs to be a widget.)
It might be okay to have something like jsvar to create and access identifiable client-side variables though
(can also be done with string and parent view id suffix, but this is a bit less safe)
Block of code associated with WebView (for now just suffix, but we need to garbage collect them as well)
Default behavior for selection and focus. Webview can have focus and selection

Group controls in form like fashion, so they only cause edit on some submit/commit edit op? (like "make reservation")
Allow specification of client-side edit op.


 form <- mkForm
 
 b1 <- mkButton
 onClick b1 <- call "disenable"
 
 t <- mkTextField
 onChange t <- call "disenable"
 commitButton <- mkButton
 onClick commitButton $ commit form
 
 
Naming
Text/TextView
RadioView 

in Main, we get (Widget Text), (Widget RadioView) etc. these will get type synonyms Text... etc.
The synonyms should be consistent with the naming in Types
 


Possible bugs

 Drag & drop code may interfere with hList and vList spacings


Escape everything
  Button text, ...
Scripting:
- Now scripts are executed after creation of node  "new eval new eval update ...", can it be necessary for an init script
   that the view tree is complete? (so we need to move all evals to the end of the list)
- Handle escaping, emitting the string </WebViewsJavaScript> will crash 
- Maybe we can create a special WebNode for scripts? Might make it easier to present them automatically and won't require the extraction.
   It would require changing Incrementality though.
   
   
   